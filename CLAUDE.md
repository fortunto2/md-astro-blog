# CLAUDE.md - Astro Zettelkasten Blog

–≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è Claude Code –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å Astro Zettelkasten –±–ª–æ–≥–æ–º.

## üÜï –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (2025-09-22)

### –°–∏—Å—Ç–µ–º–∞ –ø–æ–∏—Å–∫–∞ –Ω–∞ –±–∞–∑–µ AutoRAG
- **–î–æ–±–∞–≤–ª–µ–Ω AutoRAG –ø–æ–∏—Å–∫** —Å Cloudflare Vectorize –∏–Ω–¥–µ–∫—Å–æ–º `autorag-blog-deep`
- **–î–≤–∞ —Ä–µ–∂–∏–º–∞ –ø–æ–∏—Å–∫–∞**: AI (—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π) –∏ regular (—Ç–µ–∫—Å—Ç–æ–≤—ã–π)
- **–î–æ–º–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ –ø–∞–ø–∫–µ –≤ R2 (`folder` metadata)
- **API endpoint**: `/api/search?q=query&mode=ai|regular&domain=example.com`
- **–ü–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞**: `/search` —Å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º —Ä–µ–∂–∏–º–æ–≤
- **Highlight —Å–∏—Å—Ç–µ–º–∞** —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ localStorage

### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- **Sitemap.xml**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑ R2 —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ lastmod –¥–∞—Ç–∞–º–∏
- **llms.txt**: —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∑–∞–º–µ—Ç–æ–∫ —Å raw markdown —Å—Å—ã–ª–∫–∞–º–∏
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ª—É–∂–µ–±–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤**: –∏—Å–∫–ª—é—á–µ–Ω–∏–µ header.md, footer.md, index.md
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π baseUrl**: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º—É–ª—å—Ç–∏–¥–æ–º–µ–Ω–Ω–æ—Å—Ç–∏ –±–µ–∑ —Ö–∞—Ä–¥–∫–æ–¥–∞

### –£–ª—É—á—à–µ–Ω–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ UI
- **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏**: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–µ—Ñ–æ–ª—Ç–Ω–æ–≥–æ header –¥–ª—è –≤—Å–µ—Ö –¥–æ–º–µ–Ω–æ–≤
- **–£–±—Ä–∞–Ω—ã —Ö–∞—Ä–¥–∫–æ–¥ –¥–æ–º–µ–Ω—ã**: –≤—Å–µ —Å—Å—ã–ª–∫–∏ —Å—Ç–∞–ª–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏
- **SEO –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: sitemap –≤ HTML head, —É–¥–∞–ª–µ–Ω –∏–∑ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
- **Responsive –¥–∏–∑–∞–π–Ω**: —É–ª—É—á—à–µ–Ω–Ω–∞—è –º–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è

### –û–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **43 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–∞** (–±—ã–ª–æ 30)
- **–ù–æ–≤—ã–µ —Ç–µ—Å—Ç—ã**: –¥–æ–º–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, search API, search mode –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- **–ü–æ–∫—Ä—ã—Ç–∏–µ**: markdown –æ–±—Ä–∞–±–æ—Ç–∫–∞, wikilinks, AutoRAG –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- **–í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç**: ‚úÖ 43 passed

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- **–ú–æ–¥—É–ª—å–Ω–∞—è JavaScript –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** –¥–ª—è highlight —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- **Improved error handling** –≤ search API
- **Cloudflare bindings**: –¥–æ–±–∞–≤–ª–µ–Ω AI binding –¥–ª—è Workers AI
- **Service file filtering** –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö –ª–∏—Å—Ç–∏–Ω–≥–æ–≤

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è
–≠—Ç–æ Astro SSR (Server-Side Rendering) –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –º—É–ª—å—Ç–∏–¥–æ–º–µ–Ω–Ω–æ–≥–æ Zettelkasten –±–ª–æ–≥–∞ —Å:
- **On-the-fly —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥** markdown —Ñ–∞–π–ª–æ–≤ –∏–∑ R2 —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- **Dual endpoints**: HTML (`/n/[slug]`) –∏ raw markdown (`/n/[slug].md`)
- **Wikilinks –ø–æ–¥–¥–µ—Ä–∂–∫–∞**: `[[–∑–∞–º–µ—Ç–∫–∞]]` ‚Üí `/n/–∑–∞–º–µ—Ç–∫–∞`
- **AutoRAG –ø–æ–∏—Å–∫** —Å –≤–µ–∫—Ç–æ—Ä–Ω—ã–º –∏–Ω–¥–µ–∫—Å–æ–º –∏ AI-—Ä–µ–∂–∏–º–æ–º
- **–ú—É–ª—å—Ç–∏–¥–æ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** —Å –¥–æ–º–µ–Ω–Ω–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è** sitemap.xml –∏ llms.txt
- **–ü—É–±–ª–∏—á–Ω—ã–π/–ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç** —Å SEO –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π
- **Edge –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** —á–µ—Ä–µ–∑ Cloudflare

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
- **Astro 5.13.9** —Å SSR —Ä–µ–∂–∏–º–æ–º
- **@astrojs/cloudflare** –∞–¥–∞–ø—Ç–µ—Ä –¥–ª—è Cloudflare Pages
- **markdown-it** + **highlight.js** –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ markdown
- **Cloudflare R2** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- **Cloudflare Vectorize** –¥–ª—è –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ (`autorag-blog-deep`)
- **Cloudflare Workers AI** –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞
- **Custom domain** `content.example.com` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ R2

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
blog2/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ md.ts                    # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ markdown –æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.astro              # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (domain index + header/footer)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ search.astro             # –ü–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å AI/regular —Ä–µ–∂–∏–º–∞–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sitemap.xml.ts           # –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è sitemap
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ llms.txt.ts              # –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è llms.txt
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ n/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ [...slug].astro      # HTML —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∑–∞–º–µ—Ç–æ–∫
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ [...slug].md.ts      # API –¥–ª—è raw markdown
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ search.ts            # AutoRAG –ø–æ–∏—Å–∫ —Å –¥–æ–º–µ–Ω–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ r2/[...path].ts      # Fallback API –¥–ª—è R2 –¥–æ—Å—Ç—É–ø–∞
‚îú‚îÄ‚îÄ astro.config.mjs                 # Astro –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ wrangler.toml                    # Cloudflare Workers –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ CLAUDE.md                        # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã

### `/src/lib/md.ts`
–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å markdown:

```typescript
// –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
export async function fetchNote(slug: string): Promise<Note | null>
export function parseFrontmatter(markdown: string): { frontmatter: NoteFrontmatter; content: string }
export function processWikilinks(content: string): string
export async function fetchPage(slug: string): Promise<string | null>
export function isPrivate(frontmatter: NoteFrontmatter): boolean
export function generateMetaTags(frontmatter: NoteFrontmatter, slug: string)
export function generateDefaultHeader(domain: string): string
export function getCurrentDomain(host: string): string
export function matchesDomain(frontmatter: NoteFrontmatter, host: string): boolean
```

**–í–∞–∂–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç fallback —á–µ—Ä–µ–∑ internal API (`/api/r2/`)
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç wikilinks: `[[–∑–∞–º–µ—Ç–∫–∞]]` ‚Üí `[–∑–∞–º–µ—Ç–∫–∞](/n/–∑–∞–º–µ—Ç–∫–∞)`
- –ü—Ä–∏–≤–∞—Ç–Ω–æ–π —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞–º–µ—Ç–∫–∞, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤ frontmatter —É–∫–∞–∑–∞–Ω–æ `status: "private"`


**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ:**
- `PUBLIC_MD_BASES` –æ–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω ‚Äî –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, –µ—Å–ª–∏ —á–∏—Ç–∞–µ—Ç–µ –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ `BLOG_CONTENT`
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å CDN (–Ω–∞–ø—Ä–∏–º–µ—Ä, `https://content.example.com`), –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ fallback –∫ R2
- –ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —á–µ—Ä–µ–∑ —Ç–æ—á–∫—É —Å –∑–∞–ø—è—Ç–æ–π

## –ö–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pnpm install

# –ó–∞–ø—É—Å–∫ dev —Å–µ—Ä–≤–µ—Ä–∞ —Å R2 —ç–º—É–ª—è—Ü–∏–µ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
pnpm dev

# –°–±–æ—Ä–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
pnpm build

# –î–µ–ø–ª–æ–π –Ω–∞ Cloudflare Pages
pnpm deploy

# –¢–µ—Å—Ç—ã
pnpm test
pnpm test:run

# –õ–∏–Ω—Ç–∏–Ω–≥
pnpm lint
pnpm lint:fix
```

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –ó–∞–ø—É—Å–∫ dev —Å–µ—Ä–≤–µ—Ä–∞
pnpm dev
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º:**
- –í **dev** —Ä–µ–∂–∏–º–µ: —á–∏—Ç–∞–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç –∏–∑ –ø–∞–ø–∫–∏ `dev-content/`
- –í **production**: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç R2 –∏–ª–∏ –ø—É–±–ª–∏—á–Ω—ã–π URL –∫–∞–∫ fallback

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞:**
```
dev-content/
‚îú‚îÄ‚îÄ domain-a.example/
‚îÇ   ‚îú‚îÄ‚îÄ index.md
‚îÇ   ‚îú‚îÄ‚îÄ test-note.md
‚îÇ   ‚îî‚îÄ‚îÄ private-note.md
‚îú‚îÄ‚îÄ domain-b.example/
‚îÇ   ‚îî‚îÄ‚îÄ –¥—Ä—É–≥–∏–µ-–∑–∞–º–µ—Ç–∫–∏.md
‚îî‚îÄ‚îÄ shared/
    ‚îî‚îÄ‚îÄ global-note.md
```

**–ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤—ã—Ö URL:**
- `http://localhost:4322/` - –≥–ª–∞–≤–Ω–∞—è (domain-a.example/index.md) —Å header/footer
- `http://localhost:4322/?domain=domain-b.example` - –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è –≥–ª–∞–≤–Ω–∞—è –±–µ–∑ header
- `http://localhost:4322/n/test-note` - —Ç–µ—Å—Ç–æ–≤–∞—è –∑–∞–º–µ—Ç–∫–∞ —Å header/footer
- `http://localhost:4322/n/minimal-note?domain=domain-b.example` - –∑–∞–º–µ—Ç–∫–∞ –±–µ–∑ header/footer
- `http://localhost:4322/n/private-note` - –ø—Ä–∏–≤–∞—Ç–Ω–∞—è –∑–∞–º–µ—Ç–∫–∞
- `http://localhost:4322/n/shared/global-note` - –æ–±—â–∞—è –∑–∞–º–µ—Ç–∫–∞

### –†–∞–±–æ—Ç–∞ —Å R2 –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º
> –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç R2-–±–∏–Ω–¥–∏–Ω–≥ `BLOG_CONTENT` (bucket `sgr-blog-content`) –∏ –∏–Ω–¥–µ–∫—Å Vectorize `VECTOR_INDEX` (`autorag-blog-deep`), –æ–±—ä—è–≤–ª–µ–Ω–Ω—ã–µ –≤ `wrangler.toml`. –ù–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–π –∏–ª–∏ URL –≤ `.env` –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.
```bash
# –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤ R2 (–í–ê–ñ–ù–û: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å --remote)
pnpm r2:put sgr-blog-content/domain/filename.md --file /path/to/file.md --remote

# –ú–∞—Å—Å–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
for file in /path/to/notes/*.md; do
    filename=$(basename "$file")
    pnpm r2:put sgr-blog-content/domain/"$filename" --file "$file" --remote
done

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ (–¥–ª—è CDN fallback)
curl -I "https://content.example.com/filename.md"
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
```bash
# HTML —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥
curl "http://localhost:4322/n/note-slug"

# Raw markdown
curl "http://localhost:4322/n/note-slug.md"

# –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
curl "http://localhost:4322/"
```

## –†–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º

### Header –∏ Footer (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **header.md** ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è –¥–æ–º–µ–Ω–∞
- **footer.md** ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥–≤–∞–ª –¥–ª—è –¥–æ–º–µ–Ω–∞
- **index.md** ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–æ–∏—Å–∫–∞:**
1. –î–æ–º–µ–Ω-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π —Ñ–∞–π–ª: `{domain}/header.md`
2. –û–±—â–∏–π —Ñ–∞–π–ª: `shared/header.md`
3. –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è (header) –∏–ª–∏ fallback email (footer)

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ:**
- –° header/footer: `?domain=domain-a.example`
- –ë–µ–∑ header/footer: `?domain=domain-b.example`

### Frontmatter —Ñ–æ—Ä–º–∞—Ç
```yaml
---
title: '–ó–∞–≥–æ–ª–æ–≤–æ–∫ –∑–∞–º–µ—Ç–∫–∏'
date: '2025-09-17'
description: '–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ'
tags: ['—Ç–µ–≥1', '—Ç–µ–≥2']
category: '–∫–∞—Ç–µ–≥–æ—Ä–∏—è'
status: 'public'  # –∏–ª–∏ 'private'
domain: 'example.com'  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
cover: 'https://example.com/image.jpg'  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
aliases: ['–∞–ª–∏–∞—Å1', '–∞–ª–∏–∞—Å2']  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
---
```

### Wikilinks
```markdown
[[20250101-sample-note]]

# –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤:
[20250101-sample-note](/n/20250101-sample-note)
```

### –°—Ç–∞—Ç—É—Å –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏
- **–ü—É–±–ª–∏—á–Ω—ã–µ**: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –ª–∏–±–æ `status: 'public'`
- **–ü—Ä–∏–≤–∞—Ç–Ω—ã–µ**: —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ `status: 'private'`
- –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏ –ø–æ–ª—É—á–∞—é—Ç `noindex,nofollow` –∏ –±–∞–Ω–Ω–µ—Ä-–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

## –î–µ–ø–ª–æ–π –∏ –ø—Ä–æ–¥–∞–∫—à–µ–Ω

### –¢–µ–∫—É—â–∏–µ URL
- **–ü—Ä–æ–¥–∞–∫—à–µ–Ω**: https://2448f163.sgr-blog.pages.dev
- **Dev —Å–µ—Ä–≤–µ—Ä**: http://localhost:4322 (–µ—Å–ª–∏ 4321 –∑–∞–Ω—è—Ç)
- **R2 CDN (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**: https://content.example.com

### –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ R2 —Å `--remote`
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å `pnpm build`
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–±–æ—Ä–∫–∞ –ø—Ä–æ—à–ª–∞ –±–µ–∑ –æ—à–∏–±–æ–∫
5. –î–µ–ø–ª–æ–π: `pnpm deploy`

### Cloudflare –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```toml
# wrangler.toml
name = "sgr-blog"
compatibility_date = "2024-01-01"

[[r2_buckets]]
binding = "BLOG_CONTENT"
bucket_name = "sgr-blog-content"
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### R2 –¥–æ—Å—Ç—É–ø
**–ü—Ä–æ–±–ª–µ–º–∞**: 404 –æ—à–∏–±–∫–∏ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º —Ñ–∞–π–ª–∞–º
**–†–µ—à–µ–Ω–∏–µ**:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `--remote` —Ñ–ª–∞–≥ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ñ–∞–π–ª—ã –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ `content.example.com`

### Cloudflare –∞–¥–∞–ø—Ç–µ—Ä
**–ü—Ä–æ–±–ª–µ–º–∞**: "Cannot find module '@astrojs/cloudflare'"
**–†–µ—à–µ–Ω–∏–µ**: `pnpm add @astrojs/cloudflare`

### Dev —Å–µ—Ä–≤–µ—Ä
**–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ—Ä—Ç 4321 –∑–∞–Ω—è—Ç
**–†–µ—à–µ–Ω–∏–µ**: Astro –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–µ—Ä–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π –ø–æ—Ä—Ç (4322, 4323, etc.)

### –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Dev**: –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ
- **–ü—Ä–æ–¥–∞–∫—à–µ–Ω**:
  - HTML: `s-maxage=86400, stale-while-revalidate=604800`
  - Markdown: `max-age=0, s-maxage=86400`

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏


### –ú—É–ª—å—Ç–∏–¥–æ–º–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
**–ù–û–í–û–ï**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ –¥–æ–º–µ–Ω–∞–º –≤ –æ–¥–Ω–æ–º R2 –±–∞–∫–µ—Ç–µ:

```
sgr-blog-content/
‚îú‚îÄ‚îÄ domain-a.example/   # –ö–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –¥–æ–º–µ–Ω–∞
‚îú‚îÄ‚îÄ domain-b.example/   # –ö–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –¥–æ–º–µ–Ω–∞
‚îú‚îÄ‚îÄ shared/             # –û–±—â–∏–µ –∑–∞–º–µ—Ç–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îî‚îÄ‚îÄ *.md                # Legacy —Ñ–∞–π–ª—ã –≤ –∫–æ—Ä–Ω–µ
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–æ–∏—Å–∫–∞ –∑–∞–º–µ—Ç–æ–∫:**
1. –î–æ–º–µ–Ω-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –ø–∞–ø–∫–∞: `/{domain}/{slug}.md`
2. –û–±—â–∞—è –ø–∞–ø–∫–∞: `/shared/{slug}.md`
3. –ö–æ—Ä–Ω–µ–≤–∞—è –ø–∞–ø–∫–∞: `/{slug}.md` (legacy)

**–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞:**
```bash
# –î–æ–º–µ–Ω-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
pnpm r2:put sgr-blog-content/domain-a.example/note.md --file note.md --remote

# –û–±—â–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
pnpm r2:put sgr-blog-content/shared/global-note.md --file note.md --remote
```

–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ [DOMAINS.md](./DOMAINS.md)

### –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `src/lib/md.ts`:
- `processWikilinks()` - –ª–æ–≥–∏–∫–∞ wikilinks
- `parseFrontmatter()` - –ø–∞—Ä—Å–∏–Ω–≥ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- `generateMetaTags()` - SEO –º–µ—Ç–∞—Ç–µ–≥–∏
- `getCurrentDomain()` - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –¥–æ–º–µ–Ω–∞
- `fetchNote()` - –¥–æ–º–µ–Ω-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –ø–æ–∏—Å–∫ –∑–∞–º–µ—Ç–æ–∫

### –ù–æ–≤—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
–°–æ–∑–¥–∞—Ç—å –≤ `src/pages/`:
- `.astro` —Ñ–∞–π–ª—ã –¥–ª—è HTML —Å—Ç—Ä–∞–Ω–∏—Ü
- `.ts` —Ñ–∞–π–ª—ã –¥–ª—è API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### –õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–∞
Cloudflare –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç:
- HTTP —Å—Ç–∞—Ç—É—Å—ã
- Cache hit/miss
- Geographic data
- User agents

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- Edge –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Cloudflare
- SSR —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö/–∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ CSS/JS bundle

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
- –ù–µ –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç—Å—è –ø–æ–∏—Å–∫–æ–≤–∏–∫–∞–º–∏ (`noindex,nofollow`)
- –î–æ—Å—Ç—É–ø–µ–Ω –ø–æ –ø—Ä—è–º–æ–π —Å—Å—ã–ª–∫–µ
- –ù–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

### CORS –∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏
```javascript
headers: {
  'Content-Type': 'text/plain; charset=utf-8',
  'Cache-Control': 'public, max-age=300, s-maxage=3600',
  'Access-Control-Allow-Origin': '*',
}
```

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- **Astro Docs**: https://docs.astro.build
- **Cloudflare Pages**: https://pages.cloudflare.com
- **R2 Storage**: https://developers.cloudflare.com/r2/
- **Wrangler CLI**: https://developers.cloudflare.com/workers/wrangler/

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ H1 –≤ –Ω–∞—á–∞–ª–µ markdown –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `# –ó–∞–≥–æ–ª–æ–≤–æ–∫`, —Ç–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏–∑ frontmatter –Ω–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è
- –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- –°–≤–æ–π—Å—Ç–≤–æ `hasH1` –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ `Note` –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —ç—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **30 —Ç–µ—Å—Ç–æ–≤** –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- –¢–µ—Å—Ç—ã –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è H1, –æ–±—Ä–∞–±–æ—Ç–∫–∏ wikilinks, domain routing
- –ó–∞–ø—É—Å–∫: `pnpm test` –∏–ª–∏ `pnpm test:run`
- –õ–∏–Ω—Ç–∏–Ω–≥: `pnpm lint` —Å –∞–≤—Ç–æ—Ñ–∏–∫—Å–æ–º —á–µ—Ä–µ–∑ `pnpm lint:fix`

---

## üîç –°–∏—Å—Ç–µ–º–∞ –ø–æ–∏—Å–∫–∞ AutoRAG

### Cloudflare bindings
–ü—Ä–æ–µ–∫—Ç —Ç—Ä–µ–±—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ bindings –≤ Cloudflare Pages:
```toml
# wrangler.toml
[[r2_buckets]]
binding = "BLOG_CONTENT"
bucket_name = "sgr-blog-content"

[[vectorize]]
binding = "VECTOR_INDEX"
index_name = "autorag-blog-deep"

[ai]
binding = "AI"
```

### API endpoints
- **GET `/api/search`** - –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ–∏—Å–∫–æ–≤—ã–π endpoint
  - `q` (required) - –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
  - `mode` (optional) - —Ä–µ–∂–∏–º –ø–æ–∏—Å–∫–∞: `ai` (default) –∏–ª–∏ `regular`
  - `domain` (optional) - –¥–æ–º–µ–Ω –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ü–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ `/search`
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º –º–µ–∂–¥—É AI –∏ regular —Ä–µ–∂–∏–º–∞–º–∏
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö
- Real-time –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ JavaScript
- Responsive –¥–∏–∑–∞–π–Ω –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

### –î–æ–º–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
–ü–æ–∏—Å–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ —Ç–µ–∫—É—â–µ–º—É –¥–æ–º–µ–Ω—É:
```typescript
const domainFilter = {
  type: 'and' as const,
  filters: [
    { type: 'gte' as const, key: 'folder', value: `${domain}/` },
    { type: 'lt' as const, key: 'folder', value: `${domain}/~` }
  ]
};
```

## üìÑ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ endpoints

### Sitemap.xml (`/sitemap.xml`)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –≤ R2
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Å–ª—É–∂–µ–±–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤: `header.md`, `footer.md`, `index.md`
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ `lastmod` –¥–∞—Ç—ã –∏–∑ R2 –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ XML Schema –¥–ª—è –ø–æ–∏—Å–∫–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º

### llms.txt (`/llms.txt`)
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö –∑–∞–º–µ—Ç–æ–∫
- –°—Å—ã–ª–∫–∏ –Ω–∞ raw markdown –≤–µ—Ä—Å–∏–∏ (`.md`)
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π `baseUrl` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –º—É–ª—å—Ç–∏–¥–æ–º–µ–Ω–Ω–æ—Å—Ç–∏
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (`status: private`)

## üé® UI/UX —É–ª—É—á—à–µ–Ω–∏—è

### –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è
- –§—É–Ω–∫—Ü–∏—è `generateDefaultHeader()` —Å–æ–∑–¥–∞–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –≤—Å–µ—Ö –¥–æ–º–µ–Ω–æ–≤
- –ù–∞–∑–≤–∞–Ω–∏–µ "Blog - Zettelkasten" –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ
- –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Å—ã–ª–∫–∏: –≥–ª–∞–≤–Ω–∞—è (`/`), –ø–æ–∏—Å–∫ (`/search`), llms.txt (`/llms.txt`)
- –£–±—Ä–∞–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ sitemap –∏–∑ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ (–æ—Å—Ç–∞–µ—Ç—Å—è –≤ HTML head –¥–ª—è SEO)

### –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞
JavaScript –º–æ–¥—É–ª—å –¥–ª—è highlight —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏:
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–¥–µ–ª–µ–Ω–∏–π –≤ localStorage
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤—ã–¥–µ–ª–µ–Ω–∏–π
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–æ–∏—Å–∫–æ–≤—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è –±–∞–∑–∞ (43 —Ç–µ—Å—Ç–∞)
–ù–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `src/pages/api/search.test.ts`:
- **Domain filtering**: —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ –¥–ª—è –¥–æ–º–µ–Ω–æ–≤
- **Search mode handling**: –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `mode` (ai/regular)
- **Helper functions**: slug extraction, title parsing

–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã –≤ `src/lib/md.test.ts` –æ–±–Ω–æ–≤–ª–µ–Ω—ã:
- **generateDefaultHeader**: —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ unified –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- **Domain routing**: –º—É–ª—å—Ç–∏–¥–æ–º–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞
- **H1 detection**: –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
pnpm test:run

# Watch —Ä–µ–∂–∏–º
pnpm test

# –†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ 43 passed
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –¥–µ–ø–ª–æ–π

### Environment Variables
```bash
# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ - –¥–ª—è CDN fallback
PUBLIC_MD_BASES=""

# –î–µ—Ñ–æ–ª—Ç–Ω—ã–π –¥–æ–º–µ–Ω –¥–ª—è localhost
PUBLIC_DEFAULT_DOMAIN="domain-a.example"
```

### Cloudflare Pages setup
1. –°–æ–∑–¥–∞—Ç—å Pages –ø—Ä–æ–µ–∫—Ç —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ GitHub
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å bindings:
   - R2: `BLOG_CONTENT` ‚Üí `sgr-blog-content`
   - Vectorize: `VECTOR_INDEX` ‚Üí `autorag-blog-deep`
   - AI: `AI` ‚Üí Workers AI
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å custom domains –¥–ª—è –º—É–ª—å—Ç–∏–¥–æ–º–µ–Ω–Ω–æ—Å—Ç–∏

### –ö–æ–º–∞–Ω–¥—ã –¥–µ–ø–ª–æ—è
```bash
# –°–±–æ—Ä–∫–∞ –∏ –¥–µ–ø–ª–æ–π
pnpm build && pnpm deploy

# –ò–ª–∏ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞
pnpm deploy
```

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2025-09-22
**–í–µ—Ä—Å–∏—è Astro**: 5.13.9
**–¢–µ—Å—Ç–æ–≤**: 43 ‚úÖ
**–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**: AutoRAG –ø–æ–∏—Å–∫, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è, —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è
**–°—Ç–∞—Ç—É—Å**: –ü—Ä–æ–¥–∞–∫—à–µ–Ω –≥–æ—Ç–æ–≤ ‚úÖ



## USE SUB-AGENTS FOR CONTEXT OPTIMIZATION

### 1. Always use the file-analyzer sub-agent when asked to read files.
The file-analyzer agent is an expert in extracting and summarizing critical information from files, particularly log files and verbose outputs. It provides concise, actionable summaries that preserve essential information while dramatically reducing context usage.

### 2. Always use the code-analyzer sub-agent when asked to search code, analyze code, research bugs, or trace logic flow.

The code-analyzer agent is an expert in code analysis, logic tracing, and vulnerability detection. It provides concise, actionable summaries that preserve essential information while dramatically reducing context usage.

### 3. Always use the test-runner sub-agent to run tests and analyze the test results.

Using the test-runner agent ensures:

- Full test output is captured for debugging
- Main conversation stays clean and focused
- Context usage is optimized
- All issues are properly surfaced
- No approval dialogs interrupt the workflow
